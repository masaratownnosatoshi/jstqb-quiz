[
  {
    "id": "Q2-FIN-V110-01",
    "chapter": "第2章",
    "level": "K3",
    "category": "金融",
    "style": "シナリオ",
    "type": "単一選択",
    "question": "【適用】API連携におけるセキュリティテスト（OAuth 2.0）。\nFinTechアプリが銀行の口座情報を参照するために、OAuth 2.0を用いたAPI連携を行っている。\n認可コード（Authorization Code）の横取り攻撃を防ぐために実装されている「PKCE（Proof Key for Code Exchange）」が正しく機能しているか検証したい。\n適切なテスト方法はどれか。",
    "options": [
      "認可リクエストから `code_challenge` パラメータを削除して送信し、認可サーバーがエラー（invalid_request）を返却することを確認する",
      "認可リクエストを送信する際に、HTTPSではなくHTTPで送信し、通信が暗号化されていないことを確認する",
      "アクセストークンの有効期限が切れた後にAPIを呼び出し、リフレッシュトークンによる更新ができるかを確認する",
      "正しい `code_verifier` を持たない攻撃者が、横取りした認可コードを使ってトークン交換を試みても、成功してしまうことを確認する"
    ],
    "answer": [
      "認可リクエストから `code_challenge` パラメータを削除して送信し、認可サーバーがエラー（invalid_request）を返却することを確認する"
    ],
    "explanation": "【解説】\nPKCEのテストでは、「PKCEパラメータがない場合に拒否されるか」や「不正なverifierで拒否されるか」といったネガティブテストが重要です。",
    "tags": [
      "第2章",
      "金融",
      "シナリオ",
      "K3"
    ]
  }
]