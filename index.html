<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>JSTQB ALTM v3.0 テスト対策くん</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <main class="container">
    <header class="app-header">
      <h1>JSTQB ALTM v3.0 テスト対策くん</h1>
      <nav class="top-nav">
        <a href="#home" id="homeLink">ホーム</a>
        <a href="#dashboard" id="dashboardLink">ダッシュボード</a>
      </nav>
    </header>

    <section id="controls" data-route="home">
      
      <div style="background:#eef2f7; padding:12px; border-radius:8px; margin-bottom:20px; text-align:center; color:#2b5797; border: 1px solid #dbe4ef;">
        現在の収録問題数：<strong id="totalCount" style="font-size:1.6em; margin:0 4px;">-</strong> 問
      </div>

      <div class="row">
        <label>ユーザーID（任意）：<input id="userIdInput" type="text" placeholder="例）guest01 / 任意のニックネーム" /></label>
        <label>出題数：
          <select id="numSelect">
            <option>10</option>
            <option selected>30</option>
            <option>50</option>
          </select>
        </label>
        <div class="checkbox-group">
          <label><input type="checkbox" id="adaptiveMode" /> 苦手な箇所を優先</label>
          <label><input type="checkbox" id="calcOnlyMode" /> 【計算】問題のみ</label>
          <label style="color:#d9534f; font-weight:bold;"><input type="checkbox" id="favOnlyMode" /> ★お気に入り（要復習）</label>
        </div>
      </div>

      <details class="filters">
        <summary>絞り込み（章／Kレベル／カテゴリ）</summary>
        <div class="row">
          <div style="margin-bottom: 15px;">
            <b>章：</b>
            <div style="display:flex; flex-wrap:wrap; gap:10px;">
              <label><input type="checkbox" class="chapterFilter" value="第1章" checked>第1章</label>
              <label><input type="checkbox" class="chapterFilter" value="第2章" checked>第2章</label>
              <label><input type="checkbox" class="chapterFilter" value="第3章" checked>第3章</label>
            </div>
          </div>
          <div style="margin-bottom: 15px; border-top:1px solid #eee; padding-top:10px;">
            <b>Kレベル：</b>
            <div style="display:flex; flex-wrap:wrap; gap:10px;">
              <label><input type="checkbox" class="levelFilter" value="K2" checked>K2</label>
              <label><input type="checkbox" class="levelFilter" value="K3" checked>K3</label>
              <label><input type="checkbox" class="levelFilter" value="K4" checked>K4</label>
            </div>
          </div>
          <div style="border-top:1px solid #eee; padding-top:10px;">
            <b>カテゴリ：</b>
            <div style="display:flex; flex-wrap:wrap; gap:10px;">
              <label><input type="checkbox" class="categoryFilter" value="AWS" checked>AWS</label>
              <label><input type="checkbox" class="categoryFilter" value="クラウド" checked>クラウド</label>
              <label><input type="checkbox" class="categoryFilter" value="医療" checked>医療</label>
              <label><input type="checkbox" class="categoryFilter" value="一般" checked>一般</label>
              <label><input type="checkbox" class="categoryFilter" value="金融" checked>金融</label>
              <label><input type="checkbox" class="categoryFilter" value="チームマネジメント" checked>チームマネジメント</label>
            </div>
          </div>
        </div>
      </details>

      <div class="row">
        <button id="startBtn" type="button">この条件で開始</button>
        <a class="secondary" href="#dashboard">過去の成績を見る（ダッシュボード）</a>
      </div>
    </section>

    <section id="quiz" class="hidden" data-route="quiz">
      <div class="question-header">
        <h2 id="questionText">問題を読み込み中...</h2>
        <button id="favBtn" class="fav-btn" type="button">☆</button>
      </div>
      <div id="chapter"></div>
      <div id="level"></div>
      
      <form id="choices"></form>
      
      <div id="feedback" class="hidden">
        <h3 id="judgeResult"></h3>
        <p><strong>正解：</strong><span id="correctAnswer"></span></p>
        <p><strong>解説：</strong><span id="explanation"></span></p>
      </div>

      <div class="nav">
        <button id="submitBtn" type="button">回答する</button>
      </div>
    </section>

    <section id="results" class="hidden" data-route="results">
      <h2>結果</h2>
      <div id="passFailMessage" class="result-message"></div>
      <p>正答数：<span id="finalCorrect"></span> / <span id="totalQuestions"></span></p>
      <p>正答率：<span id="finalRate"></span>%</p>
      <canvas id="chapterChart" width="600" height="280"></canvas>
      <canvas id="kChart" width="600" height="280"></canvas>
      <div class="row">
        <button id="restartBtn" type="button">条件を変えてやり直す</button>
        <a class="secondary" href="#dashboard">ダッシュボードへ</a>
      </div>
    </section>

    <section id="dashboard" class="hidden" data-route="dashboard">
      <h2>ダッシュボード</h2>
      <p>匿名ID：<span id="anonIdLabel"></span></p>
      <div class="cards">
        <div class="card">
          <h3>累計成績</h3>
          <p>総回答数：<span id="totalAnswered"></span></p>
          <p>総正答数：<span id="totalCorrect"></span></p>
          <p>累計正答率：<span id="totalRate"></span>%</p>
        </div>
        <div class="card">
          <h3>弱点</h3>
          <ul id="weakAreas"></ul>
        </div>
      </div>
      <canvas id="chapterChartAll" width="600" height="280"></canvas>
      <div class="row">
        <button id="clearDataBtn" class="danger" type="button">データを削除</button>
        <a class="secondary" href="#home">TOPへ戻る</a>
      </div>
    </section>

    <div id="meta" class="hidden">
      <div>問題：<span id="progress">-</span></div>
      <div>正答：<span id="score">0</span></div>
      <button id="goHomeBtn" class="danger">TOPへ戻る</button>
    </div>

    <footer>
      <small>© 2026 JSTQB ALTM v3.0 Practice</small>
    </footer>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="app.js?v=4"></script>
</body>
</html>